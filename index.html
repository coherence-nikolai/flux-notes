<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flux Notes ‚Äî Your Way of Thinking</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&family=Atkinson+Hyperlegible:wght@400;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0f1117; --surface: #1a1d27; --surface2: #232638;
    --accent: #7eb8f7; --accent2: #a78bfa; --confusion: #fb923c;
    --success: #6ee7b7; --text: #e8eaf0; --text-muted: #8b90a8;
    --border: rgba(255,255,255,0.08); --radius: 16px; --radius-sm: 10px;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Atkinson Hyperlegible', sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }
  body::before {
    content: ''; position: fixed; top: -50%; left: -50%; width: 200%; height: 200%;
    background: radial-gradient(ellipse at 30% 20%, rgba(126,184,247,0.06) 0%, transparent 50%),
                radial-gradient(ellipse at 70% 80%, rgba(167,139,250,0.06) 0%, transparent 50%);
    pointer-events: none; z-index: 0;
  }
  .app { position: relative; z-index: 1; max-width: 800px; margin: 0 auto; padding: 20px 16px 100px; }
  .header { text-align: center; padding: 32px 0 24px; }
  .logo {
    font-family: 'Nunito', sans-serif; font-size: 2rem; font-weight: 800;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  }
  .tagline { font-size: 0.95rem; color: var(--text-muted); margin-top: 6px; }
  .session-bar {
    background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius);
    padding: 14px 18px; display: flex; align-items: center; gap: 12px; margin-bottom: 20px;
  }
  .session-input { flex: 1; background: transparent; border: none; color: var(--text); font-family: 'Atkinson Hyperlegible', sans-serif; font-size: 1rem; outline: none; }
  .session-input::placeholder { color: var(--text-muted); }
  .btn-start {
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border: none; border-radius: var(--radius-sm); color: #0f1117;
    font-family: 'Nunito', sans-serif; font-weight: 700; font-size: 0.9rem;
    padding: 10px 20px; cursor: pointer; transition: opacity 0.2s, transform 0.1s; white-space: nowrap;
  }
  .btn-start:hover { opacity: 0.9; transform: scale(1.02); }
  .session-indicator { display: none; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--success); font-weight: 600; }
  .session-indicator.visible { display: flex; }
  .dot-live { width: 8px; height: 8px; border-radius: 50%; background: var(--success); animation: blink 2s infinite; }
  @keyframes blink { 0%,100%{opacity:1}50%{opacity:0.3} }
  .mode-selector { display: flex; gap: 8px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 4px; scrollbar-width: none; }
  .mode-selector::-webkit-scrollbar { display: none; }
  .mode-btn {
    background: var(--surface); border: 1px solid var(--border); border-radius: 50px;
    color: var(--text-muted); font-family: 'Nunito', sans-serif; font-weight: 600;
    font-size: 0.85rem; padding: 8px 18px; cursor: pointer; transition: all 0.2s; white-space: nowrap; flex-shrink: 0;
  }
  .mode-btn.active { background: linear-gradient(135deg, rgba(126,184,247,0.2), rgba(167,139,250,0.2)); border-color: var(--accent); color: var(--accent); }
  .mode-btn:hover:not(.active) { border-color: var(--text-muted); color: var(--text); }
  .panel { display: none; }
  .panel.active { display: block; animation: fadeIn 0.3s ease; }
  @keyframes fadeIn { from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)} }
  .note-area { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 20px; min-height: 320px; }
  .note-textarea { width: 100%; min-height: 280px; background: transparent; border: none; color: var(--text); font-family: 'Atkinson Hyperlegible', sans-serif; font-size: 1.05rem; line-height: 1.8; outline: none; resize: none; }
  .note-textarea::placeholder { color: var(--text-muted); }
  .cornell-grid {
    display: grid; grid-template-columns: 200px 1fr; grid-template-rows: 1fr auto;
    gap: 2px; background: var(--border); border-radius: var(--radius); overflow: hidden; min-height: 400px;
  }
  .cornell-cue { background: var(--surface); padding: 16px; grid-row: 1; grid-column: 1; }
  .cornell-main { background: var(--surface); padding: 16px; grid-row: 1; grid-column: 2; }
  .cornell-summary { background: var(--surface2); padding: 16px; grid-row: 2; grid-column: 1 / 3; }
  .cornell-label { font-family: 'Nunito', sans-serif; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; color: var(--accent2); margin-bottom: 10px; display: block; }
  .cornell-ta { width: 100%; background: transparent; border: none; color: var(--text); font-family: 'Atkinson Hyperlegible', sans-serif; font-size: 0.95rem; line-height: 1.7; outline: none; resize: none; min-height: 200px; }
  .cornell-ta.summary { min-height: 80px; }
  .cornell-ta::placeholder { color: var(--text-muted); }
  .voice-panel { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 32px 20px; text-align: center; }
  .voice-btn {
    width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--accent);
    background: rgba(126,184,247,0.1); color: var(--accent); font-size: 2.5rem;
    cursor: pointer; transition: all 0.2s; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center;
  }
  .voice-btn:hover { background: rgba(126,184,247,0.2); transform: scale(1.05); }
  .voice-btn.recording { border-color: #ef4444; background: rgba(239,68,68,0.15); color: #ef4444; animation: pulse-rec 1.5s infinite; }
  @keyframes pulse-rec { 0%,100%{box-shadow:0 0 0 0 rgba(239,68,68,0.3)}50%{box-shadow:0 0 0 16px rgba(239,68,68,0)} }
  .voice-status { font-size: 0.95rem; color: var(--text-muted); margin-bottom: 16px; }
  .voice-recordings { text-align: left; margin-top: 20px; }
  .recording-item { background: var(--surface2); border-radius: var(--radius-sm); padding: 12px 16px; margin-bottom: 8px; display: flex; align-items: center; gap: 12px; font-size: 0.9rem; }
  .recording-item audio { flex: 1; height: 36px; }
  .rec-time { color: var(--text-muted); font-size: 0.8rem; white-space: nowrap; }
  .confusion-zone { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%); z-index: 100; }
  .confusion-btn {
    background: linear-gradient(135deg, var(--confusion), #f97316);
    border: none; border-radius: 50px; color: white;
    font-family: 'Nunito', sans-serif; font-weight: 800; font-size: 1rem;
    padding: 14px 28px; cursor: pointer; box-shadow: 0 4px 24px rgba(251,146,60,0.4);
    transition: all 0.2s; display: flex; align-items: center; gap: 8px;
  }
  .confusion-btn:hover { transform: scale(1.05); box-shadow: 0 6px 32px rgba(251,146,60,0.5); }
  .confusion-btn:active { transform: scale(0.97); }
  .confusion-count { background: rgba(255,255,255,0.25); border-radius: 50px; padding: 2px 10px; font-size: 0.85rem; }
  .confusion-log { margin-top: 24px; }
  .section-title { font-family: 'Nunito', sans-serif; font-weight: 700; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1.5px; color: var(--text-muted); margin-bottom: 12px; }
  .confusion-item {
    background: var(--surface); border: 1px solid rgba(251,146,60,0.2); border-left: 3px solid var(--confusion);
    border-radius: var(--radius-sm); padding: 12px 16px; margin-bottom: 8px; display: flex; align-items: flex-start; gap: 12px;
    animation: slideIn 0.3s ease;
  }
  @keyframes slideIn { from{opacity:0;transform:translateX(-8px)}to{opacity:1;transform:translateX(0)} }
  .confusion-timestamp { font-size: 0.8rem; color: var(--confusion); font-weight: 600; white-space: nowrap; margin-top: 2px; }
  .confusion-note-input { flex: 1; background: transparent; border: none; color: var(--text); font-family: 'Atkinson Hyperlegible', sans-serif; font-size: 0.9rem; outline: none; resize: none; line-height: 1.5; }
  .confusion-note-input::placeholder { color: var(--text-muted); font-style: italic; }
  .tools-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 12px; }
  .tool-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 16px; text-decoration: none; color: var(--text); transition: all 0.2s; display: block; }
  .tool-card:hover { border-color: var(--accent); transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.3); }
  .tool-icon { font-size: 1.8rem; margin-bottom: 8px; }
  .tool-name { font-family: 'Nunito', sans-serif; font-weight: 700; font-size: 1rem; margin-bottom: 4px; }
  .tool-desc { font-size: 0.82rem; color: var(--text-muted); line-height: 1.5; }
  .tool-tag { display: inline-block; margin-top: 8px; font-size: 0.72rem; background: rgba(126,184,247,0.12); color: var(--accent); border-radius: 50px; padding: 2px 10px; font-weight: 600; }
  .review-section { margin-bottom: 24px; }
  .review-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 20px; }
  .review-card h3 { font-family: 'Nunito', sans-serif; font-weight: 700; font-size: 1rem; color: var(--accent); margin-bottom: 12px; }
  .review-content { font-size: 0.95rem; line-height: 1.7; color: var(--text-muted); white-space: pre-wrap; word-break: break-word; }
  .export-btn { background: var(--surface2); border: 1px solid var(--border); border-radius: var(--radius-sm); color: var(--text); font-family: 'Nunito', sans-serif; font-weight: 600; font-size: 0.9rem; padding: 10px 20px; cursor: pointer; transition: all 0.2s; margin-right: 8px; margin-top: 12px; }
  .export-btn:hover { border-color: var(--accent); color: var(--accent); }
  .toast { position: fixed; top: 24px; right: 24px; background: var(--confusion); color: white; font-family: 'Nunito', sans-serif; font-weight: 700; font-size: 0.9rem; padding: 12px 20px; border-radius: var(--radius-sm); z-index: 200; opacity: 0; transform: translateY(-8px); transition: all 0.3s; pointer-events: none; }
  .toast.show { opacity: 1; transform: translateY(0); }
  .empty-state { text-align: center; padding: 40px 20px; color: var(--text-muted); font-size: 0.95rem; }
  .empty-state .emoji { font-size: 2.5rem; margin-bottom: 12px; display: block; }
  *:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }
  @media (max-width: 560px) {
    .cornell-grid { grid-template-columns: 1fr; }
    .cornell-cue { grid-row: 1; grid-column: 1; }
    .cornell-main { grid-row: 2; grid-column: 1; }
    .cornell-summary { grid-row: 3; grid-column: 1; }
  }
</style>
</head>
<body>

<div class="app">
  <div class="header">
    <div class="logo">‚ú¶ Flux Notes</div>
    <div class="tagline">Your brain. Your way of thinking.</div>
  </div>

  <div class="session-bar">
    <input class="session-input" id="sessionName" type="text" placeholder="What are you studying today?" aria-label="Session name" />
    <div class="session-indicator" id="sessionIndicator"><span class="dot-live"></span> Live</div>
    <button class="btn-start" id="startBtn">Start Session</button>
  </div>

  <div class="mode-selector" role="tablist" aria-label="Note-taking modes">
    <button class="mode-btn active" data-mode="free" role="tab" aria-selected="true">‚úèÔ∏è Free Notes</button>
    <button class="mode-btn" data-mode="cornell" role="tab" aria-selected="false">üìã Cornell</button>
    <button class="mode-btn" data-mode="voice" role="tab" aria-selected="false">üéôÔ∏è Voice</button>
    <button class="mode-btn" data-mode="review" role="tab" aria-selected="false">üîç Review</button>
    <button class="mode-btn" data-mode="tools" role="tab" aria-selected="false">üîó Tools</button>
  </div>

  <!-- FREE NOTES -->

  <div class="panel active" id="panel-free">
    <div class="note-area">
      <textarea class="note-textarea" id="freeNotes" placeholder="Just start writing. No rules. No judgment. Your thoughts belong here..." aria-label="Free notes"></textarea>
    </div>
    <div class="confusion-log" id="confusionLog-free"></div>
  </div>

  <!-- CORNELL -->

  <div class="panel" id="panel-cornell">
    <div class="cornell-grid">
      <div class="cornell-cue">
        <span class="cornell-label">‚ùì Questions &amp; Cues</span>
        <textarea class="cornell-ta" id="cornellCue" placeholder="Key questions, things to come back to, words you don't know..." aria-label="Cornell cues"></textarea>
      </div>
      <div class="cornell-main">
        <span class="cornell-label">üìù Main Notes</span>
        <textarea class="cornell-ta" id="cornellMain" placeholder="Your main notes during the lecture. Don't worry about it being perfect..." aria-label="Cornell main notes"></textarea>
      </div>
      <div class="cornell-summary">
        <span class="cornell-label">üí° Summary ‚Äî fill this in after the lecture</span>
        <textarea class="cornell-ta summary" id="cornellSummary" placeholder="In your own words: what were the 3 key things from this lecture?" aria-label="Cornell summary"></textarea>
      </div>
    </div>
    <div class="confusion-log" id="confusionLog-cornell"></div>
  </div>

  <!-- VOICE -->

  <div class="panel" id="panel-voice">
    <div class="voice-panel">
      <button class="voice-btn" id="voiceBtn" aria-label="Record voice note">üéôÔ∏è</button>
      <div class="voice-status" id="voiceStatus">Tap to record a voice note</div>
      <p style="font-size:0.85rem;color:var(--text-muted);max-width:320px;margin:0 auto;line-height:1.6;">
        When typing feels like too much ‚Äî just speak. Your thoughts are valid however they come out.
      </p>
      <div class="voice-recordings" id="voiceRecordings"></div>
    </div>
    <div class="confusion-log" id="confusionLog-voice"></div>
  </div>

  <!-- REVIEW -->

  <div class="panel" id="panel-review">
    <div class="review-section">
      <div class="review-card">
        <h3>Free Notes</h3>
        <div class="review-content" id="review-free">‚Äî</div>
      </div>
    </div>
    <div class="review-section">
      <div class="review-card">
        <h3>Cornell ‚Äî Cues &amp; Questions</h3>
        <div class="review-content" id="review-cue">‚Äî</div>
        <h3 style="margin-top:16px">Cornell ‚Äî Main Notes</h3>
        <div class="review-content" id="review-main">‚Äî</div>
        <h3 style="margin-top:16px">Cornell ‚Äî Summary</h3>
        <div class="review-content" id="review-summary">‚Äî</div>
      </div>
    </div>
    <div class="review-section">
      <div class="section-title">üü† Confusion Moments ‚Äî find these points in your lecture recording</div>
      <div id="review-confusion"></div>
    </div>
    <button class="export-btn" id="copyBtn">üìã Copy All Notes</button>
    <button class="export-btn" id="downloadBtn">‚¨áÔ∏è Download as Text</button>
  </div>

  <!-- TOOLS -->

  <div class="panel" id="panel-tools">
    <div class="section-title" style="margin-bottom:16px">Specialist tools ‚Äî each one built for different needs</div>
    <div class="tools-grid">
      <a href="https://otter.ai" target="_blank" rel="noopener" class="tool-card">
        <div class="tool-icon">üéß</div>
        <div class="tool-name">Otter.ai</div>
        <div class="tool-desc">Live transcription of lectures. Never miss a word even when focus drifts.</div>
        <span class="tool-tag">ADHD ¬∑ Dyslexia</span>
      </a>
      <a href="https://ankiweb.net" target="_blank" rel="noopener" class="tool-card">
        <div class="tool-icon">üÉè</div>
        <div class="tool-name">Anki</div>
        <div class="tool-desc">Spaced repetition flashcards. Review at exactly the right moment for memory.</div>
        <span class="tool-tag">ADHD ¬∑ All</span>
      </a>
      <a href="https://speechify.com" target="_blank" rel="noopener" class="tool-card">
        <div class="tool-icon">üîä</div>
        <div class="tool-name">Speechify</div>
        <div class="tool-desc">Turns any text into speech. Research papers, notes, anything ‚Äî listen instead of read.</div>
        <span class="tool-tag">Dyslexia ¬∑ Autism</span>
      </a>
      <a href="https://www.mindmeister.com" target="_blank" rel="noopener" class="tool-card">
        <div class="tool-icon">üï∏Ô∏è</div>
        <div class="tool-name">MindMeister</div>
        <div class="tool-desc">Visual mind mapping. For thinkers who work in webs, not lines.</div>
        <span class="tool-tag">Autism ¬∑ Visual thinkers</span>
      </a>
      <a href="https://www.naturalreaders.com" target="_blank" rel="noopener" class="tool-card">
        <div class="tool-icon">üìñ</div>
        <div class="tool-name">Natural Reader</div>
        <div class="tool-desc">Free text-to-speech with dyslexia-friendly fonts and reading overlays.</div>
        <span class="tool-tag">Dyslexia</span>
      </a>
      <a href="https://notion.so" target="_blank" rel="noopener" class="tool-card">
        <div class="tool-icon">üóÇÔ∏è</div>
        <div class="tool-name">Notion</div>
        <div class="tool-desc">Connect ideas across subjects. Build your own system in your own way.</div>
        <span class="tool-tag">Organisation</span>
      </a>
    </div>
  </div>
</div>

<div class="confusion-zone">
  <button class="confusion-btn" id="confusionBtn" aria-label="Log confusion ‚Äî I lost the thread">
    ü§Ø Lost the thread <span class="confusion-count" id="confusionCount">0</span>
  </button>
</div>

<div class="toast" id="toast"></div>

<script>
(function() {
  var sessionActive = false;
  var sessionStartTime = null;
  var confusionPoints = [];
  var mediaRecorder = null;
  var audioChunks = [];
  var isRecording = false;
  var recordingCount = 0;

  // --- SESSION ---
  document.getElementById('startBtn').addEventListener('click', function() {
    if (!sessionActive) {
      sessionActive = true;
      sessionStartTime = new Date();
      this.textContent = 'End Session';
      this.style.background = 'linear-gradient(135deg, #6b7280, #4b5563)';
      document.getElementById('sessionIndicator').classList.add('visible');
    } else {
      sessionActive = false;
      this.textContent = 'Start Session';
      this.style.background = '';
      document.getElementById('sessionIndicator').classList.remove('visible');
      buildReview();
      switchMode('review');
    }
  });

  // --- MODE TABS ---
  document.querySelectorAll('.mode-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      switchMode(this.getAttribute('data-mode'));
    });
  });

  function switchMode(mode) {
    document.querySelectorAll('.panel').forEach(function(p) { p.classList.remove('active'); });
    document.querySelectorAll('.mode-btn').forEach(function(b) {
      b.classList.remove('active');
      b.setAttribute('aria-selected', 'false');
    });
    document.getElementById('panel-' + mode).classList.add('active');
    var activeBtn = document.querySelector('[data-mode="' + mode + '"]');
    if (activeBtn) { activeBtn.classList.add('active'); activeBtn.setAttribute('aria-selected', 'true'); }
    if (mode === 'review') buildReview();
  }

  // --- CONFUSION BUTTON ---
  document.getElementById('confusionBtn').addEventListener('click', function() {
    var now = new Date();
    var timeStr;
    if (sessionStartTime) {
      var elapsed = Math.floor((now - sessionStartTime) / 1000);
      var m = Math.floor(elapsed / 60).toString().padStart(2, '0');
      var s = (elapsed % 60).toString().padStart(2, '0');
      timeStr = m + ':' + s + ' into session';
    } else {
      timeStr = now.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
    }
    confusionPoints.push({ time: timeStr, note: '', id: Date.now() });
    document.getElementById('confusionCount').textContent = confusionPoints.length;
    renderConfusionItems();
    showToast('Confusion logged ‚úì ‚Äî go back to your recording at this point');
  });

  function renderConfusionItems() {
    ['confusionLog-free', 'confusionLog-cornell', 'confusionLog-voice'].forEach(function(id) {
      var el = document.getElementById(id);
      if (!el) return;
      if (confusionPoints.length === 0) { el.innerHTML = ''; return; }
      var html = '<div class="section-title" style="margin-top:24px">üü† Confusion Moments ‚Äî go back to your lecture recording at these points</div>';
      confusionPoints.forEach(function(cp, i) {
        html += '<div class="confusion-item">' +
          '<div class="confusion-timestamp">' + cp.time + '</div>' +
          '<textarea class="confusion-note-input" data-index="' + i + '" placeholder="What were you confused about? Fill in after reviewing your recording..." rows="2">' + cp.note + '</textarea>' +

```
      '</div>';
  });
  el.innerHTML = html;
  el.querySelectorAll('.confusion-note-input').forEach(function(ta) {
    ta.addEventListener('change', function() {
      var idx = parseInt(this.getAttribute('data-index'));
      if (confusionPoints[idx]) confusionPoints[idx].note = this.value;
    });
  });
});
```

}

// ‚Äî VOICE RECORDING ‚Äî
document.getElementById(‚ÄòvoiceBtn‚Äô).addEventListener(‚Äòclick‚Äô, function() {
if (!isRecording) {
navigator.mediaDevices.getUserMedia({ audio: true }).then(function(stream) {
mediaRecorder = new MediaRecorder(stream);
audioChunks = [];
mediaRecorder.addEventListener(‚Äòdataavailable‚Äô, function(e) { audioChunks.push(e.data); });
mediaRecorder.addEventListener(‚Äòstop‚Äô, function() {
var blob = new Blob(audioChunks, { type: ‚Äòaudio/webm‚Äô });
var url = URL.createObjectURL(blob);
recordingCount++;
var now = new Date().toLocaleTimeString([], {hour:‚Äò2-digit‚Äô, minute:‚Äò2-digit‚Äô});
var container = document.getElementById(‚ÄòvoiceRecordings‚Äô);
if (!container.querySelector(‚Äô.section-title‚Äô)) {
var title = document.createElement(‚Äòdiv‚Äô);
title.className = ‚Äòsection-title‚Äô;
title.style.marginBottom = ‚Äò12px‚Äô;
title.textContent = ‚ÄòYour voice notes‚Äô;
container.appendChild(title);
}
var item = document.createElement(‚Äòdiv‚Äô);
item.className = ‚Äòrecording-item‚Äô;
var audio = document.createElement(‚Äòaudio‚Äô);
audio.controls = true;
audio.src = url;
item.innerHTML = ‚Äò<span>üéôÔ∏è #‚Äô + recordingCount + ‚Äò</span>‚Äô;
item.appendChild(audio);
var timeEl = document.createElement(‚Äòspan‚Äô);
timeEl.className = ‚Äòrec-time‚Äô;
timeEl.textContent = now;
item.appendChild(timeEl);
container.appendChild(item);
stream.getTracks().forEach(function(t) { t.stop(); });
});
mediaRecorder.start();
isRecording = true;
document.getElementById(‚ÄòvoiceBtn‚Äô).classList.add(‚Äòrecording‚Äô);
document.getElementById(‚ÄòvoiceBtn‚Äô).textContent = ‚Äò‚èπÔ∏è‚Äô;
document.getElementById(‚ÄòvoiceStatus‚Äô).textContent = ‚ÄòRecording‚Ä¶ tap to stop‚Äô;
}).catch(function() {
document.getElementById(‚ÄòvoiceStatus‚Äô).textContent = ‚ÄòMicrophone access needed ‚Äî check your browser settings‚Äô;
});
} else {
mediaRecorder.stop();
isRecording = false;
document.getElementById(‚ÄòvoiceBtn‚Äô).classList.remove(‚Äòrecording‚Äô);
document.getElementById(‚ÄòvoiceBtn‚Äô).textContent = ‚ÄòüéôÔ∏è‚Äô;
document.getElementById(‚ÄòvoiceStatus‚Äô).textContent = ‚ÄòSaved ‚úì Tap to record another‚Äô;
}
});

// ‚Äî REVIEW ‚Äî
function buildReview() {
document.getElementById(‚Äòreview-free‚Äô).textContent = document.getElementById(‚ÄòfreeNotes‚Äô).value || ‚ÄòNo free notes this session.‚Äô;
document.getElementById(‚Äòreview-cue‚Äô).textContent = document.getElementById(‚ÄòcornellCue‚Äô).value || ‚Äò‚Äî‚Äô;
document.getElementById(‚Äòreview-main‚Äô).textContent = document.getElementById(‚ÄòcornellMain‚Äô).value || ‚Äò‚Äî‚Äô;
document.getElementById(‚Äòreview-summary‚Äô).textContent = document.getElementById(‚ÄòcornellSummary‚Äô).value || ‚Äò‚Äî‚Äô;
var confEl = document.getElementById(‚Äòreview-confusion‚Äô);
if (confusionPoints.length === 0) {
confEl.innerHTML = ‚Äò<div class="empty-state"><span class="emoji">‚úì</span>No confusion moments logged this session.</div>‚Äô;
} else {
var html = ‚Äò‚Äô;
confusionPoints.forEach(function(cp) {
html += ‚Äò<div class="confusion-item"><div class="confusion-timestamp">‚Äô + cp.time + ‚Äò</div>‚Äô +
‚Äò<div style="font-size:0.9rem;color:var(--text-muted);flex:1">‚Äô + (cp.note || ‚ÄòGo back to your recording at this point‚Äô) + ‚Äò</div></div>‚Äô;
});
confEl.innerHTML = html;
}
}

// ‚Äî EXPORT ‚Äî
document.getElementById(‚ÄòcopyBtn‚Äô).addEventListener(‚Äòclick‚Äô, function() {
var text = buildExportText();
navigator.clipboard.writeText(text).then(function() { showToast(‚ÄòNotes copied to clipboard ‚úì‚Äô); });
});

document.getElementById(‚ÄòdownloadBtn‚Äô).addEventListener(‚Äòclick‚Äô, function() {
var session = document.getElementById(‚ÄòsessionName‚Äô).value || ‚Äòflux-notes‚Äô;
var text = buildExportText();
var blob = new Blob([text], {type: ‚Äòtext/plain‚Äô});
var a = document.createElement(‚Äòa‚Äô);
a.href = URL.createObjectURL(blob);
a.download = session.replace(/\s+/g, ‚Äò-‚Äô) + ‚Äò-notes.txt‚Äô;
a.click();
});

function buildExportText() {
var session = document.getElementById(‚ÄòsessionName‚Äô).value || ‚ÄòSession‚Äô;
var text = ‚ÄôFLUX NOTES ‚Äî ‚Äô + session + ‚Äò\n‚Äô + ‚Äò=‚Äô.repeat(40) + ‚Äò\n\n‚Äô;
var free = document.getElementById(‚ÄòfreeNotes‚Äô).value;
if (free) text += ‚ÄòFREE NOTES:\n‚Äô + free + ‚Äò\n\n‚Äô;
var cue = document.getElementById(‚ÄòcornellCue‚Äô).value;
var main = document.getElementById(‚ÄòcornellMain‚Äô).value;
var sum = document.getElementById(‚ÄòcornellSummary‚Äô).value;
if (cue || main || sum) text += ‚ÄôCORNELL:\nCues: ‚Äô + cue + ‚Äô\nNotes: ‚Äô + main + ‚Äô\nSummary: ‚Äô + sum + ‚Äò\n\n‚Äô;
if (confusionPoints.length > 0) {
text += ‚ÄòCONFUSION MOMENTS:\n‚Äô;
confusionPoints.forEach(function(cp) {
text += ‚Äô‚Ä¢ ‚Äô + cp.time + ‚Äô: ‚Äô + (cp.note || ‚ÄòReview recording at this point‚Äô) + ‚Äò\n‚Äô;
});
}
return text;
}

// ‚Äî TOAST ‚Äî
function showToast(msg) {
var t = document.getElementById(‚Äòtoast‚Äô);
t.textContent = msg;
t.classList.add(‚Äòshow‚Äô);
setTimeout(function() { t.classList.remove(‚Äòshow‚Äô); }, 2800);
}

})();
</script>

</body>
</html>
